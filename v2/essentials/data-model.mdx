---
title: 'Data Model'
icon: 'database'
---

The Custom Fields package provides a flexible system for adding dynamic fields to any entity in your application. The data model consists of four main tables that work together to define field structures, organize them into sections, provide selectable options, and store the actual field values.

## **Overview**

```
CustomFieldSection (1) ──→ (M) CustomField (1) ──→ (M) CustomFieldOption
                                      │
                                      ↓ (1)
                               CustomFieldValue (M) ──→ (1) Entity (Polymorphic)
```

## **Tables**

### **custom_field_sections**
Groups related custom fields together for better organization and UI presentation.

| Column | Type | Constraints | Description |
|--------|------|-------------|-------------|
| `id` | BIGINT UNSIGNED | Primary Key | Unique identifier |
| `tenant_id` | BIGINT UNSIGNED | Nullable, Indexed | Multi-tenancy support |
| `width` | VARCHAR(255) | Nullable | UI display width |
| `code` | VARCHAR(255) | Required | Unique section identifier |
| `name` | VARCHAR(255) | Required | Display name |
| `type` | VARCHAR(255) | Required | Section type |
| `entity_type` | VARCHAR(255) | Required | Associated model class |
| `sort_order` | BIGINT UNSIGNED | Nullable | Display order |
| `description` | VARCHAR(255) | Nullable | Section description |
| `active` | BOOLEAN | Default: true | Visibility status |
| `system_defined` | BOOLEAN | Default: false | System-managed flag |
| `settings` | JSON | Nullable | Additional configuration |
| `timestamps` | TIMESTAMP | Auto-managed | Created/updated dates |

**Unique:** `entity_type`, `code` (+ `tenant_id` if enabled)

### **custom_fields**
Defines the individual custom fields that can be added to entities.

| Column | Type | Constraints | Description |
|--------|------|-------------|-------------|
| `id` | BIGINT UNSIGNED | Primary Key | Unique identifier |
| `custom_field_section_id` | BIGINT UNSIGNED | Nullable, FK | Parent section reference |
| `tenant_id` | BIGINT UNSIGNED | Nullable, Indexed | Multi-tenancy support |
| `width` | VARCHAR(255) | Nullable | UI display width |
| `code` | VARCHAR(255) | Required | Unique field identifier |
| `name` | VARCHAR(255) | Required | Display name |
| `type` | VARCHAR(255) | Required | Field data type |
| `lookup_type` | VARCHAR(255) | Nullable | Lookup/relation type |
| `entity_type` | VARCHAR(255) | Required | Associated model class |
| `sort_order` | BIGINT UNSIGNED | Nullable | Display order |
| `validation_rules` | JSON | Nullable | Field validation rules |
| `active` | BOOLEAN | Default: true | Visibility status |
| `system_defined` | BOOLEAN | Default: false | System-managed flag |
| `settings` | JSON | Nullable | Additional configuration |
| `timestamps` | TIMESTAMP | Auto-managed | Created/updated dates |

**Unique:** `code`, `entity_type` (+ `tenant_id` if enabled)

### **custom_field_options**
Stores predefined choices for select fields and other option-based field types.

| Column | Type | Constraints | Description |
|--------|------|-------------|-------------|
| `id` | BIGINT UNSIGNED | Primary Key | Unique identifier |
| `tenant_id` | BIGINT UNSIGNED | Nullable, Indexed | Multi-tenancy support |
| `custom_field_id` | BIGINT UNSIGNED | Required, FK | Parent field reference |
| `name` | VARCHAR(255) | Nullable | Option label/value |
| `sort_order` | BIGINT UNSIGNED | Nullable | Display order |
| `settings` | JSON | Nullable | Additional configuration |
| `timestamps` | TIMESTAMP | Auto-managed | Created/updated dates |

**Unique:** `custom_field_id`, `name` (+ `tenant_id` if enabled)  
**Cascade:** Deletes when parent field is deleted

### **custom_field_values**
Stores the actual values for custom fields, polymorphically linked to any entity.

| Column | Type | Constraints | Description |
|--------|------|-------------|-------------|
| `id` | BIGINT UNSIGNED | Primary Key | Unique identifier |
| `tenant_id` | BIGINT UNSIGNED | Nullable, Indexed | Multi-tenancy support |
| `entity_type` | VARCHAR(255) | Required | Model class name |
| `entity_id` | BIGINT UNSIGNED | Required | Model instance ID |
| `custom_field_id` | BIGINT UNSIGNED | Required, FK | Field definition reference |
| `string_value` | TEXT | Nullable | Short text values |
| `text_value` | LONGTEXT | Nullable | Long text values |
| `boolean_value` | BOOLEAN | Nullable | Boolean values |
| `integer_value` | BIGINT | Nullable | Integer values |
| `float_value` | DOUBLE | Nullable | Decimal values |
| `date_value` | DATE | Nullable | Date values |
| `datetime_value` | DATETIME | Nullable | DateTime values |
| `json_value` | JSON | Nullable | Complex/array values |

**Unique:** `entity_type`, `entity_id`, `custom_field_id` (+ `tenant_id` if enabled)  
**Cascade:** Deletes when parent field is deleted  
**Polymorphic:** Links to any model via `entity_type` and `entity_id`

## **Key Relationships**

- **Section → Fields**: One section can contain many fields (optional relationship)
- **Field → Options**: One field can have many predefined options (for select types)
- **Field → Values**: One field can have many values across different entity instances
- **Value → Entity**: Each value belongs to one specific entity instance (polymorphic)

## **Multi-tenancy Support**

When multi-tenancy is enabled, all tables include a `tenant_id` column that:
- References a `tenants` table
- Is included in unique constraints to prevent conflicts across tenants
- Is indexed for query performance
- Ensures complete data isolation between tenants

